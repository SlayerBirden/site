# This is a part of Maketok Site. Licensed under GPL 3.0
# @project site
# @developer Oleg Kulik slayer.birden@gmail.com maketok.com

services:

  adapter:
    class: Zend\Db\Adapter\Adapter
    arguments:
      - driver: "%db_driver%"
        hostname: "%db_host%"
        database: "%db_database%"
        username: "%db_user%"
        password: "%db_passw%"

  directory_handler:
    class: Maketok\Util\DirectoryHandler

  lock_stream_handler:
    class: Maketok\Util\StreamHandler

  object_prop_hydrator:
    class: Maketok\Util\Hydrator\ObjectProperty

  logger_handler:
    class: Maketok\Util\Monolog\Handler\StreamHandler
    arguments: ["%log_dir%site.log", 100]

  logger:
    class: Monolog\Logger
    arguments: ["application_logger", ["@logger_handler"]]

  zend_sql_platform:
    class: Zend\Db\Sql\Platform\Platform
    arguments: ["@adapter"]

  zend_db_sql:
    class: Maketok\Util\Zend\Db\Sql\Sql
    arguments: ["@adapter", ~, "@zend_sql_platform"]

  request:
    synthetic: true

  #main app service
  site:
    synthetic: true
